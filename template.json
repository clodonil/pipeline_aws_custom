{
    "Resources": {
        "Build": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "linuxdockerhub",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "Build",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/python37/build/buildspec.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        },
        "DeployECS": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "aws/codebuild/standard:2.0",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "DeployECS",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/common/deploy/buildspec_ecs.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        },
        "PipelineTest": {
            "Properties": {
                "ArtifactStore": {
                    "Location": "PipelineTest",
                    "Type": "S3"
                },
                "RoleArn": "arnrole",
                "Stages": [
                    {
                        "Actions": [
                            {
                                "ActionTypeId": {
                                    "Category": "Source",
                                    "Owner": "AWS",
                                    "Provider": "CodeCommit",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "BranchName": "master",
                                    "RepositoryName": "teste"
                                },
                                "Name": "SourceApp",
                                "OutputArtifacts": [
                                    {
                                        "Name": "SourceApp"
                                    }
                                ],
                                "RunOrder": "1"
                            }
                        ],
                        "Name": "Source"
                    },
                    {
                        "Actions": [
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "TestUnit",
                                "OutputArtifacts": [
                                    {
                                        "Name": "TestUnit"
                                    }
                                ],
                                "RunOrder": "1"
                            },
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "TestUnit",
                                "OutputArtifacts": [
                                    {
                                        "Name": "TestUnit"
                                    }
                                ],
                                "RunOrder": "1"
                            },
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "TestUnit",
                                "OutputArtifacts": [
                                    {
                                        "Name": "TestUnit"
                                    }
                                ],
                                "RunOrder": "1"
                            },
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "TestUnit",
                                "OutputArtifacts": [
                                    {
                                        "Name": "TestUnit"
                                    }
                                ],
                                "RunOrder": "1"
                            },
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "Aqua",
                                "OutputArtifacts": [
                                    {
                                        "Name": "Aqua"
                                    }
                                ],
                                "RunOrder": "2"
                            }
                        ],
                        "Name": "CI"
                    },
                    {
                        "Actions": [
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "Publish",
                                "OutputArtifacts": [
                                    {
                                        "Name": "Publish"
                                    }
                                ],
                                "RunOrder": "1"
                            }
                        ],
                        "Name": "Publish"
                    },
                    {
                        "Actions": [
                            {
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "Configuration": {
                                    "PrimarySource": "SourceApp",
                                    "ProjectName": "CODEBUILDteste"
                                },
                                "Name": "Deploy",
                                "OutputArtifacts": [
                                    {
                                        "Name": "Deploy"
                                    }
                                ],
                                "RunOrder": "1"
                            }
                        ],
                        "Name": "Deploy"
                    }
                ]
            },
            "Type": "AWS::CodePipeline::Pipeline"
        },
        "PublishECR": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "aws/codebuild/standard:2.0",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "PublishECR",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/common/publish/buildspec_ecr.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        },
        "SAST": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "linuxdockerhub",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "SAST",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/python37/build/buildspec.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        },
        "SONAR": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "linuxdockerhub",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "SONAR",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/python37/build/buildspec.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        },
        "TestUnit": {
            "Properties": {
                "Artifacts": {
                    "Type": "CODEPIPELINE"
                },
                "EncryptionKey": "aaa:aaa:aa",
                "Environment": {
                    "ComputeType": "BUILD_GENERAL1_LARGE",
                    "EnvironmentVariables": [
                        {
                            "chave1": "valor1"
                        }
                    ],
                    "Image": "linuxdockerhub",
                    "PrivilegedMode": "true",
                    "Type": "LINUX_CONTAINER"
                },
                "Name": "TestUnit",
                "ServiceRole": "RolePipeline",
                "Source": {
                    "BuildSpec": "/python37/build/buildspec.yml",
                    "Type": "CODEPIPELINE"
                },
                "TimeoutInMinutes": 10,
                "VpcConfig": {
                    "SecurityGroupIds": [
                        "sg-51530134"
                    ],
                    "Subnets": [
                        "sunet1",
                        "subnet2"
                    ],
                    "VpcId": "vpc-2f09a348"
                }
            },
            "Type": "AWS::CodeBuild::Project"
        }
    }
}
